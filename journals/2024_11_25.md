- 关于对单片机程序流的[[心智模型]]（以[[Arduino]]为例）
	- 从软件迁移过来，会觉得单片机就是只有一个线程的进程，但这里有一个决定性的差异——进程和线程是**被操作系统调度**的，而单片机的程序流**自己调度自己**；因此，单片机有着更大的自由度，不能以之前进程-线程的心智模型去思考单片机的程序流。
	- 从程序员的角度，最初只能看到setup函数和loop函数，单片机启动后执行setup函数，然后反复执行loop函数。这是唯一的程序流吗？答案是否定的——晶振又不是专门给CPU用的，任何连到这个晶振上的东西，都可以认为是程序流。一个典型的例子是硬件PWM——即使CPU在忙其他事情，PWM仍旧能维持输出，**就像另一台计算机**，CPU能做的，只是调整这一台“计算机”的配置。
	- 实践上来说，还存在另一类程序流——**中断Interrupt**。
	- 中断有多种类型，包括外部中断——特定引脚的电平变化时触发；定时器中断——周期性执行；串口中断——接受到串口数据，其他中断——和特定外设设备相关联的中断，如ADC，SPI等
	- loop函数执行时，如果此时触发了中断且该中断注册了ISR（中断服务程序Interrupt Service Routine，可以理解为事件的回调函数），则硬件底层会停止loop函数的执行，保存此时的上下文，执行ISR，再回滚上下文，继续执行。这就是为什么loop函数中不能做要求实时性的操作——它经常会被中断去打断。中断是存在优先级，且可以嵌套的，而loop的优先级很低。
	- 实际上，中断在单片机（乃至桌面计算机）中起了很大的作用，它使得外界能够“通知”计算机发生了某事并要求它来进行处理，而不必让计算机反复轮询，从而让计算机在底层就对**异步**有所支持，能够提高性能和实时性，减少程序复杂性，同时也更好地支持计算机的多任务处理功能，即使只有一个线程在工作。